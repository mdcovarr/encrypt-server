import hashlib
generator = 967717815276424335658597955626422458994419174497969907337157673886123656638205469226076197861249549004480841387043360197071017811130707990685744514558595068941725067952556006237862391064159647193542530329259333442485175693941842684712007646242422926508000403302669078971670934589486761637846920089591711726342061843805812789899990816663915282671085039813609522242829719587993249808317734238106660385861768230295679126590839097244478220392871782842745758326756009749518752261780971503339957101241429278086064519161884670803755256928075030040725829571759962567416958199028585508053574180142683126826804771118716296486230523760774389715749479154235237931126825997489514734133523549901600330751339003899015821961418539362798639669975431713371350926815830845181534326423028370436056697857918994988629688023563560002153140124962200937852164145182161084793162729526892933590160284681369008253980150977651701597571404654558482636180694648894782471449354358221269399650775453765824765529395288811662441509565199205733657279155210616750060391443188845224391244598246511947071570694256382613964010021678095711923378088547657654209783183271262387278417872172708262072964856821330955727615106330602713152230040271215
prime = 2773513095749167337576358874942831569385761553923082020361322269992944848900679812023279146301350522850090002404933303945902936699221541739407031093375604510782932978211887782609382749284217900289408825694570778270715497001472804773372159699487464437256876108641279314813575799288035356082872639030264782216353159219092583471370767587415147909582899797092757606928692808037575206687764512220547200620789059472015069219482248258148634825249349597280042484353178956233483223727571140311838306949799799389653659585365956460017964867528486207333566527882029528403924411542682289926608743840478132959386352700434705248478356021620623246182957756186469188241103927864116660349640671385022766484753851141361332470536679473435624975951398678223471940968044118426926416547424017470194979727791050258667142662067685046402556400795278419058391263239633600041551667467165519541808705130094613958692430907777974227738480151928447986789521779568788608228476360075320041347313425785218891003810100229345370916722563279782990542182337909274843389264316019902839366994034965244475466733634646851920984543901636177633543005383561910647171815817852671314062388162598842918605113346738598363605906911837209914533050012879383


#parameters are integers, return type is pair of integers
def get_k1_and_k2(my_private_diffie_key,your_public_diffie_key):
    agreed_key = pow(generator,my_private_diffie_key*your_public_diffie_key,prime)
    #https://stackoverflow.com/questions/46533953/convert-int-to-byte-in-python
    hash = hashlib.sha3_512(str(agreed_key).encode()).hexdigest()
    k1 = int(hash[0:64],16)
    k2 = int(hash[64:],16)
    return k1, k2


